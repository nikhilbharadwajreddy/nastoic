<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Nastoic — Profile</title>
  <style>
    /* removes the “Don’t have an account? Sign up” footer */
    .cl-auth-form__footer,
    a[aria-label="Sign up"] {
      display: none !important;
    }
  </style>

  <!-- Load Clerk script from CDN -->
  <script
    src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@5/dist/clerk.browser.js"
    data-clerk-publishable-key="pk_live_Y2xlcmsubmFzdG9pYy5jb20k"
    defer
  ></script>
</head>
<body>
  <div class="apple-container">
    <div class="apple-card">
      <div class="apple-header">
        <h1>Nastoic</h1>
        <button id="sign-out" class="apple-button apple-button-secondary">Sign Out</button>
      </div>
      
      <div class="apple-title">
        <h2>Complete Your Profile</h2>
        <p>Please provide your information below.</p>
      </div>

      <form id="profile-form" class="apple-form">
        <div class="apple-form-row">
          <div class="apple-form-group">
            <label for="firstname" class="apple-form-label">First name</label>
            <input
              type="text"
              name="firstname"
              id="firstname"
              class="apple-form-input"
              placeholder="First name"
            />
          </div>
          <div class="apple-form-group">
            <label for="lastname" class="apple-form-label">Last name</label>
            <input
              type="text"
              name="lastname"
              id="lastname"
              class="apple-form-input"
              placeholder="Last name"
            />
          </div>
        </div>

        <div class="apple-form-row">
          <div class="apple-form-group">
            <label for="email" class="apple-form-label">Email</label>
            <input
              type="email"
              name="email"
              id="email"
              class="apple-form-input"
              placeholder="Email address"
              readonly
            />
          </div>
          <div class="apple-form-group">
            <label for="phone" class="apple-form-label">Phone number</label>
            <input
              type="tel"
              name="phone"
              id="phone"
              class="apple-form-input"
              placeholder="Phone number"
            />
          </div>
        </div>

        <div class="apple-form-group apple-form-full">
          <label for="address" class="apple-form-label">Street Address</label>
          <input
            type="text"
            name="address"
            id="address"
            class="apple-form-input"
            placeholder="Street address"
          />
        </div>

        <div class="apple-form-group apple-form-full">
          <label for="address2" class="apple-form-label">Street Address Line 2</label>
          <input
            type="text"
            name="address2"
            id="address2"
            class="apple-form-input"
            placeholder="Apt, suite, unit, building, floor, etc."
          />
        </div>

        <div class="apple-form-row">
          <div class="apple-form-group">
            <label for="state" class="apple-form-label">State/Province</label>
            <input
              type="text"
              name="state"
              id="state"
              class="apple-form-input"
              placeholder="State or province"
            />
          </div>
          <div class="apple-form-group">
            <label for="country" class="apple-form-label">Country</label>
            <input
              type="text"
              name="country"
              id="country"
              class="apple-form-input"
              placeholder="Country"
            />
          </div>
        </div>

        <div class="apple-form-row">
          <div class="apple-form-group">
            <label for="post" class="apple-form-label">Post/Zip code</label>
            <input
              type="text"
              name="post"
              id="post"
              class="apple-form-input"
              placeholder="Postal or zip code"
            />
          </div>
          <div class="apple-form-group">
            <label for="area" class="apple-form-label">Area Code</label>
            <input
              type="text"
              name="area"
              id="area"
              class="apple-form-input"
              placeholder="Area code"
            />
          </div>
        </div>

        <div class="apple-checkbox-wrapper">
          <input type="checkbox" id="supportCheckbox" class="apple-checkbox" />
          <label for="supportCheckbox" class="apple-checkbox-label">
            I agree to the <a href="#">Terms and Conditions</a> and <a href="#">Privacy Policy</a>
          </label>
        </div>

        <div class="apple-form-actions">
          <button type="submit" class="apple-button apple-button-primary">Save Profile</button>
        </div>
      </form>
    </div>
  </div>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background-color: #f5f5f7;
      color: #1d1d1f;
      line-height: 1.47059;
      font-weight: 400;
      letter-spacing: -0.022em;
    }
    
    .apple-container {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      min-height: 100vh;
    }
    
    .apple-card {
      max-width: 680px;
      width: 100%;
      background: #ffffff;
      border-radius: 18px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      padding: 40px;
      transition: all 0.3s ease;
    }
    
    .apple-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 32px;
      padding-bottom: 16px;
      border-bottom: 1px solid #d2d2d7;
    }
    
    .apple-header h1 {
      font-size: 27px;
      font-weight: 500;
      letter-spacing: -0.05em;
      color: #1d1d1f;
    }
    
    .apple-title {
      margin-bottom: 32px;
    }
    
    .apple-title h2 {
      font-weight: 500;
      font-size: 21px;
      letter-spacing: -0.022em;
      color: #1d1d1f;
      margin-bottom: 6px;
    }
    
    .apple-title p {
      font-size: 14px;
      color: #86868b;
    }
    
    .apple-form {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    
    .apple-form-row {
      display: flex;
      gap: 16px;
    }
    
    .apple-form-group {
      flex: 1;
      min-width: 0;
    }
    
    .apple-form-full {
      width: 100%;
    }
    
    .apple-form-label {
      display: block;
      font-size: 12px;
      color: #1d1d1f;
      margin-bottom: 6px;
      font-weight: 500;
    }
    
    .apple-form-input {
      width: 100%;
      border: 1px solid #d2d2d7;
      border-radius: 10px;
      padding: 12px 16px;
      font-size: 14px;
      color: #1d1d1f;
      background-color: #ffffff;
      transition: all 0.2s ease;
    }
    
    .apple-form-input:focus {
      outline: none;
      border-color: #0071e3;
      box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.1);
    }
    
    .apple-form-input::placeholder {
      color: #86868b;
    }
    
    .apple-checkbox-wrapper {
      display: flex;
      align-items: center;
      margin-top: 8px;
      margin-bottom: 8px;
    }
    
    .apple-checkbox {
      -webkit-appearance: none;
      appearance: none;
      background-color: #fff;
      margin: 0;
      width: 16px;
      height: 16px;
      border: 1px solid #d2d2d7;
      border-radius: 4px;
      display: grid;
      place-content: center;
      cursor: pointer;
    }
    
    .apple-checkbox::before {
      content: "";
      width: 8px;
      height: 8px;
      transform: scale(0);
      transition: 120ms transform ease-in-out;
      box-shadow: inset 1em 1em #0071e3;
      transform-origin: center;
      clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%);
    }
    
    .apple-checkbox:checked::before {
      transform: scale(1);
    }
    
    .apple-checkbox:focus {
      outline: none;
      border-color: #0071e3;
      box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.1);
    }
    
    .apple-checkbox-label {
      font-size: 14px;
      color: #1d1d1f;
      margin-left: 8px;
      cursor: pointer;
    }
    
    .apple-checkbox-label a {
      color: #0071e3;
      text-decoration: none;
    }
    
    .apple-checkbox-label a:hover {
      text-decoration: underline;
    }
    
    .apple-form-actions {
      display: flex;
      justify-content: flex-end;
      margin-top: 16px;
    }
    
    .apple-button {
      display: inline-block;
      font-size: 14px;
      font-weight: 400;
      text-align: center;
      border-radius: 980px;
      padding: 8px 16px;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease;
      min-width: 28px;
      min-height: 28px;
    }
    
    .apple-button-primary {
      background: #0071e3;
      color: #ffffff;
    }
    
    .apple-button-primary:hover {
      background: #0077ED;
    }
    
    .apple-button-secondary {
      background: #f5f5f7;
      color: #1d1d1f;
    }
    
    .apple-button-secondary:hover {
      background: #e8e8ed;
    }
    
    @media (max-width: 768px) {
      .apple-form-row {
        flex-direction: column;
        gap: 16px;
      }
      
      .apple-card {
        border-radius: 14px;
        padding: 30px 20px;
      }
      
      .apple-header {
        flex-direction: column;
        gap: 16px;
        align-items: flex-start;
      }
      
      .apple-form-actions {
        justify-content: center;
      }
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        // Wait for Clerk to initialize
        await Clerk.load();

        // Redirect to login if no session
        if (!Clerk.user) {
          window.location.href = '/';
          return;
        }

        // Populate name fields if available
        if (Clerk.user.firstName) {
          document.getElementById('firstname').value = Clerk.user.firstName;
        }
        
        if (Clerk.user.lastName) {
          document.getElementById('lastname').value = Clerk.user.lastName;
        }
        
        // If first and last name aren't available but full name is
        if (!Clerk.user.firstName && !Clerk.user.lastName && Clerk.user.fullName) {
          const nameParts = Clerk.user.fullName.split(' ');
          if (nameParts.length > 0) {
            document.getElementById('firstname').value = nameParts[0];
            if (nameParts.length > 1) {
              document.getElementById('lastname').value = nameParts.slice(1).join(' ');
            }
          }
        }
        
        // Set email (read-only)
        if (Clerk.user.primaryEmailAddress) {
          document.getElementById('email').value = Clerk.user.primaryEmailAddress.emailAddress;
        }

        // Handle form submission
        document.getElementById('profile-form').addEventListener('submit', async (e) => {
          e.preventDefault();
          
          // Check if terms checkbox is checked
          const termsChecked = document.getElementById('supportCheckbox').checked;
          if (!termsChecked) {
            alert('Please agree to the terms and conditions before proceeding.');
            return;
          }
          
          // Get form data
          const formData = new FormData(e.target);
          const userData = Object.fromEntries(formData.entries());
          
          try {
            // Here you would send data to your backend
            // For now, just show a success message
            alert('Profile updated successfully!');
            
            // You could also update some user metadata in Clerk if needed
            // await Clerk.user.update({
            //   firstName: userData.firstname,
            //   lastName: userData.lastname,
            //   // Other fields would need to be stored in metadata
            // });
          } catch (error) {
            console.error('Error saving profile:', error);
            alert('There was an error saving your profile. Please try again.');
          }
        });

        // Handle sign-out
        document.getElementById('sign-out').addEventListener('click', async () => {
          try {
            await Clerk.signOut();
            window.location.href = '/';
          } catch (error) {
            console.error('Error signing out:', error);
          }
        });
        
      } catch (error) {
        console.error('Error initializing Clerk:', error);
        alert('There was an error loading your profile. Please refresh the page or try again later.');
      }
    });
  </script>
</body>
</html>